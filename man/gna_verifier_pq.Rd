% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gna_verifier_pq.R
\name{gna_verifier_pq}
\alias{gna_verifier_pq}
\title{Verify (and fix) scientific names (Genus species) of a phyloseq object.}
\usage{
gna_verifier_pq(
  physeq,
  taxonomic_rank = c("Genus", "Species"),
  data_sources = c(1, 12),
  all_matches = FALSE,
  capitalize = FALSE,
  species_group = FALSE,
  fuzzy_uninomial = FALSE,
  stats = FALSE,
  main_taxon_threshold = 0.5,
  verbose = TRUE,
  add_to_phyloseq = FALSE,
  genus_species_canonical_col = TRUE
)
}
\arguments{
\item{physeq}{A phyloseq object}

\item{taxonomic_rank}{(Character)
The column(s) present in the @tax_table slot of the phyloseq object. Can
be a vector of two columns (e.g. the default c("Genus", "Species")).}

\item{data_sources}{A character or integer vector.
See [taxize::gna_verifier] documentation. For example,
1=Catalogue of Life, 3=ITIS, 5=Index Fungarum, 11=GBIF backbone and
210=TaxRef.}

\item{all_matches}{(Logical) See [taxize::gna_verifier] documentation.}

\item{capitalize}{(Logical) See [taxize::gna_verifier] documentation.}

\item{species_group}{(Logical) See [taxize::gna_verifier] documentation.}

\item{fuzzy_uninomial}{(Logical) See [taxize::gna_verifier] documentation.}

\item{stats}{(Logical) See [taxize::gna_verifier] documentation.}

\item{main_taxon_threshold}{(numeric) See [taxize::gna_verifier]
documentation.}

\item{verbose}{(logical, default TRUE) If TRUE, prompt some messages.}

\item{add_to_phyloseq}{(logical, default FALSE)

 - If FALSE, return the result of the [taxize::gna_verifier]
   function + a column taxa_names_in_phyloseq depicting the name of the
   taxa from the phyloseq object.

 - If TRUE return a phyloseq object with amended slot `@taxtable`.
   Three new columns are added:
   - submittedName: The character string sent to gna_verifier (e.g.
   `Antrodiella brasiliensis`)
   - currentName: The current accepted name (resolve the synonymie) with
     autorities at the end of the binominal name (e.g.
     `Trametopsis brasiliensis (Ryvarden & de Meijer) Gómez-Mont. & Robledo)`.
   - currentCanonicalSimple: The current accepted name whithout autorities
     (e.g. `Trametopsis brasiliensis`).}

\item{genus_species_canonical_col}{(logical, default TRUE) If TRUE
two new columns are added along with "currentCanonicalSimple":
"currentCanonicalSimpleGenus" and "currentCanonicalSimpleSpecies"}
}
\value{
Either a tibble (if add_to_phyloseq = FALSE) or a new phyloseq object
  with 3 new columns (see param add_to_phyloseq) in the tax_table slot.
}
\description{
A wrapper of [taxize::gna_verifier] apply to phyloseq object
}
\details{
This function is mainly a wrapper of the work of others.
  Please cite `taxize` package.
}
\examples{
gna_verifier_pq(data_fungi)

gna_verifier_pq(data_fungi, data_sources = 210)

data_fungi_mini_cleanNames <- gna_verifier_pq(data_fungi_mini,
  add_to_phyloseq = TRUE
)


data_fungi_cleanNames <- gna_verifier_pq(data_fungi,
  add_to_phyloseq = TRUE
)
sum(!is.na(data_fungi_cleanNames@tax_table[, "currentName"]))
sum(data_fungi_cleanNames@tax_table[, "currentCanonicalSimple"] != data_fungi_cleanNames@tax_table[, "submittedName"], na.rm = TRUE)
# 1010 taxa (71\% of total) are identified using a currentName including 434
# corrected values (correction using synonym disambiguation)

tr <- rotl_pq(data_fungi_cleanNames,
  taxonomic_rank = "currentCanonicalSimple",
  context_name = "Basidiomycetes"
)

p <- ggtree::ggtree(tr, layout = "roundrect") +
  ggtree::geom_nodelab(hjust = 1, vjust = -1.2, size = 2) +
  ggtree::geom_tiplab(size = 2)

p + xlim(0, max(p$data$x) + 1)

# Return an error
# data_fungi_cleanNames <- gna_verifier_pq(data_fungi_cleanNames,
#                                        add_to_phyloseq=TRUE)
# data_fungi_cleanNames <- gna_verifier_pq(data_fungi,
#                                        taxonomic_rank="G_s")

}
\author{
Adrien Taudière
}
