% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tax_occur_multi_check_pq.R
\name{tax_occur_multi_check_pq}
\alias{tax_occur_multi_check_pq}
\title{Check for taxa occurrences within a radius around multiple samples using GBIF data}
\usage{
tax_occur_multi_check_pq(
  physeq = NULL,
  taxonomic_rank = "currentCanonicalSimple",
  min_occur = 0,
  verbose = TRUE,
  lon_column = NULL,
  longitudes = NULL,
  lat_column = NULL,
  latitudes = NULL,
  ...
)
}
\arguments{
\item{physeq}{(required) A phyloseq object.}

\item{taxonomic_rank}{The taxonomic rank to use for the check. Default is
"currentCanonicalSimple" which corresponds to the cleaned scientific names in
the phyloseq object if [gna_verifier_pq()] was used with default parameter.}

\item{min_occur}{Minimum number of occurrences in the radius to keep the taxon
(default: 0).}

\item{verbose}{(Logical, default: TRUE). Whether to print progress messages.}

\item{lon_column}{Column name in sample_data containing longitudes.}

\item{longitudes}{Vector of longitudes corresponding to samples in the phyloseq object.
If provided, it overrides lon_column.}

\item{lat_column}{Column name in sample_data containing latitudes.}

\item{latitudes}{Vector of latitudes corresponding to samples in the phyloseq
object. If provided, it overrides lat_column.}

\item{...}{Additional parameters passed to [tax_occur_check()].}
}
\value{
A list containing:
 - A tibble resulting from the concatenation of result of function
  [tax_occur_check()] for each GPS position.
 - A matrix of samples x taxa with the number of occurrences in the radius
   for each case of the matrix.
 - A new phyloseq object with taxa filtered based on min_occur. Be careful,
 the filtering may be very stringent.
 @export
}
\description{
This function performs a species range check for taxa contained in a phyloseq
object, for multiple samples based on their geographic coordinates (longitude
and latitude).
}
\examples{
res_occur_check <-
  tax_occur_multi_check_pq(subset_samples(data_fungi_mini_cleanNames, Diameter == 52),
    longitudes = c(8.31, 8.31, 8.64, -1.19, 7.03),
    latitudes = c(47.38, 47.38, 45.83, 43.65, 43.93)
  )
}
\author{
Adrien TaudiÃ¨re
}
